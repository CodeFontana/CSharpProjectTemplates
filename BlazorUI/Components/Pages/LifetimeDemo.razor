@page "/LifetimeDemo/{Reset:bool?}"
@inject NavigationManager NavMan

<h3>Lifetime Demo</h3>

<h4>Enhanced Navigation Form</h4>
<form class="d-inline" data-enhance method="post" @formname="enhancedForm" @onsubmit="IncrementCount">
    <AntiforgeryToken />
    <input type="number" @bind-value="@CurrentCount" name="CurrentCount" hidden />
    <button class="btn btn-primary" type="submit">Click me</button>
    <a class="btn btn-secondary" href="/LifetimeDemo/true">Reset</a>
</form>

<h4 class="mt-3">Classic Form</h4>
<form class="d-inline" method="post" @formname="classicForm" @onsubmit="IncrementCount">
    <AntiforgeryToken />
    <input type="number" @bind-value="@CurrentCount" name="CurrentCount" hidden />
    <button class="btn btn-primary" type="submit">Click me</button>
    <a class="btn btn-secondary" href="/LifetimeDemo/true">Reset</a>
</form>

<h4 class="mt-3">Static</h4>
@for (int i = 0; i < CurrentCount; i++)
{
    <LifetimeComponent />
}

<h4 class="mt-3">Interactive</h4>
@for (int i = 0; i < CurrentCount; i++)
{
    <LifetimeComponent @rendermode="InteractiveServer" />
}

@code {
    [SupplyParameterFromForm]
    public int CurrentCount { get; set; } = 1;

    [Parameter]
    public bool Reset { get; set; }

    private void IncrementComponents()
    {
        CurrentCount++;
    }

    private void RefreshPage()
    {
        NavMan.NavigateTo("/LifetimeDemo");
    }

    private void IncrementCount()
    {
        CurrentCount += 1;
    }
}
