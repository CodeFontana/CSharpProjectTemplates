@inherits LayoutComponentBase
@inject NavigationManager NavMan
@inject ILocalStorageService LocalStorage
@inject IWebHostEnvironment WebHostEnv

<PageTitle>Blazor Server</PageTitle>

<MudThemeProvider Theme="_currentTheme" />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="0" Style="@(_currentTheme == lightTheme ? "background-color: var(--mud-palette-primary);" : "background-color: inherit;")">

        @if (_drawerOpen == false)
        {
            <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="() => _drawerOpen = !_drawerOpen" />
            <MudText Typo="Typo.h6" Style="white-space: nowrap">Blazor Server</MudText>
        }

        <MudSpacer />

        @if (_currentTheme == lightTheme)
        {
            <MudButton OnClick="@((e) => ToggleThemeAsync())"><MudIcon Icon="@Icons.Material.Filled.DarkMode" Color="Color.Default"></MudIcon></MudButton>
        }
        else
        {
            <MudButton OnClick="@((e) => ToggleThemeAsync())"><MudIcon Icon="@Icons.Material.Filled.LightMode"></MudIcon></MudButton>
        }

    </MudAppBar>

    <MudDrawer @bind-Open="_drawerOpen" Elevation="1" Color="@(_currentTheme == lightTheme ? Color.Secondary : Color.Dark)">
        <MudDrawerHeader Class="d-flex align-center">
            <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="() => _drawerOpen = !_drawerOpen" />
            <MudText Typo="Typo.h6" Style="white-space: nowrap">Blazor Server</MudText>
        </MudDrawerHeader>
        <MudDrawerContainer>

            <MudNavLink Href="/" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home">
                <MudText Typo="Typo.body1">Home</MudText>
            </MudNavLink>

            @if (WebHostEnv.IsDevelopment())
            {
                <MudNavLink Href="/theme" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Palette">
                    <MudText Typo="Typo.body1">Themes</MudText>
                </MudNavLink>
            }

        </MudDrawerContainer>
    </MudDrawer>

    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.False" Class="pt-4">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    private MudTheme _currentTheme = new();
    private bool _drawerOpen = true;

    protected override async Task OnInitializedAsync()
    {
        string theme = await LocalStorage.GetItemAsync<string>("Theme");

        if (string.IsNullOrWhiteSpace(theme)
            || string.Equals(theme, "Dark", System.StringComparison.CurrentCultureIgnoreCase))
        {
            _currentTheme = darkTheme;
        }
        else
        {
            _currentTheme = lightTheme;
        }
    }

    private async Task ToggleThemeAsync()
    {
        if (_currentTheme == lightTheme)
        {
            _currentTheme = darkTheme;
            await LocalStorage.SetItemAsync("Theme", "Dark");
        }
        else
        {
            _currentTheme = lightTheme;
            await LocalStorage.SetItemAsync("Theme", "Light");
        }
    }

    private MudTheme lightTheme = new()
        {
            Typography = new()
            {
                Default = new()
                {
                    //FontFamily = new[] { "Lato", "-apple-system", "BlinkMacSystemFont", "Segoe UI", "Roboto", "Helvetica Neue", "Arial", "sans-serif", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol" }
                }
            },
            Palette = new()
            {
                Black = "#000000FF",
                White = "#FFFFFFFF",

                Primary = "#4D4D86",
                PrimaryDarken = "#37375F",
                PrimaryLighten = "#7777B1",
                PrimaryContrastText = "#FFFFFFFF",

                Secondary = "#4a4e69",
                SecondaryDarken = "#35384B",
                SecondaryLighten = "#747A9D",
                SecondaryContrastText = "#FFFFFFFF",

                Tertiary = "#8d99ae",
                TertiaryDarken = "#5E6C84",
                TertiaryLighten = "#AEB7C6",
                TertiaryContrastText = "#FFFFFFFF",

                Info = "#0dcaf0",
                InfoDarken = "#0992AD",
                InfoLighten = "#52DBF6",
                InfoContrastText = "#FFFFFFFF",

                Success = "#198754",
                SuccessDarken = "#125F3B",
                SuccessLighten = "#2BD887",
                SuccessContrastText = "#FFFFFFFF",

                Warning = "#ffc107",
                WarningDarken = "#BA8B00",
                WarningLighten = "#FFD24D",
                WarningContrastText = "#FFFFFFFF",

                Error = "#dc3545",
                ErrorDarken = "#A71E2B",
                ErrorLighten = "#E6717C",
                ErrorContrastText = "#FFFFFFFF",

                Dark = "#424242FF",
                DarkDarken = "#2E2E2E",
                DarkLighten = "#575757",
                DarkContrastText = "#FFFFFFFF",

                TextPrimary = "#424242ff",
                TextSecondary = "#00000089",
                TextDisabled = "#00000060",

                ActionDefault = "#00000089",
                ActionDisabled = "#00000042",
                ActionDisabledBackground = "#0000001E",

                Background = "#FFFFFFFF",
                BackgroundGrey = "#F5F5F5FF",

                Surface = "#FFFFFFFF",

                DrawerBackground = "#FFFFFFFF",
                DrawerText = "#424242FF",
                DrawerIcon = "#F1F1F1FF",

                AppbarBackground = "#594AE2FF",
                AppbarText = "#FFFFFFFF",

                LinesDefault = "#0000001E",
                LinesInputs = "#BDBDBDFF",

                TableLines = "#E0E0E0FF",
                TableStriped = "#00000005",
                TableHover = "#0000000A",

                Divider = "#E0E0E0FF",
                DividerLight = "#000000CC",

                HoverOpacity = 0.06,

                GrayDefault = "#95A5A6",
                GrayLight = "#B4BCC2",
                GrayLighter = "#ECF0F1",
                GrayDark = "#7B8A8B",
                GrayDarker = "#343A40",

                OverlayDark = "rgba(33,33,33,0.4980392156862745)",
                OverlayLight = "rgba(255,255,255,0.4980392156862745)"
            }
        };

    private MudTheme darkTheme = new()
        {
            Typography = new()
            {
                Default = new()
                {
                    //FontFamily = new[] { "Lato", "-apple-system", "BlinkMacSystemFont", "Segoe UI", "Roboto", "Helvetica Neue", "Arial", "sans-serif", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol" }
                }
            },
            Palette = new()
            {
                Black = "#27272F",
                White = "#FFFFFFFF",

                Primary = "#4D4D86",
                PrimaryDarken = "#37375F",
                PrimaryLighten = "#7777B1",
                PrimaryContrastText = "#FFFFFFFF",

                Secondary = "#4a4e69",
                SecondaryDarken = "#35384B",
                SecondaryLighten = "#747A9D",
                SecondaryContrastText = "#FFFFFFFF",

                Tertiary = "#8d99ae",
                TertiaryDarken = "#5E6C84",
                TertiaryLighten = "#AEB7C6",
                TertiaryContrastText = "#FFFFFFFF",

                Info = "#4A86FFFF",
                InfoDarken = "#2970FF",
                InfoLighten = "#70A0FF",
                InfoContrastText = "#FFFFFFFF",

                Success = "#3DCB6CFF",
                SuccessDarken = "#2FB15B",
                SuccessLighten = "#5ED485",
                SuccessContrastText = "#FFFFFFFF",

                Warning = "#FFB545FF",
                WarningDarken = "#FFA724",
                WarningLighten = "#FFC670",
                WarningContrastText = "#FFFFFFFF",

                Error = "#FF3F5FFF",
                ErrorDarken = "#FF1A40",
                ErrorLighten = "#FF6680",
                ErrorContrastText = "#FFFFFFFF",

                Dark = "#424242FF",
                DarkDarken = "#2E2E2E",
                DarkLighten = "#575757",
                DarkContrastText = "#FFFFFFFF",

                TextPrimary = "rgba(255,255,255, 0.70)",
                TextSecondary = "rgba(255,255,255, 0.50)",
                TextDisabled = "rgba(255,255,255, 0.2)",

                ActionDefault = "#ADADB1",
                ActionDisabled = "rgba(255,255,255, 0.26)",
                ActionDisabledBackground = "rgba(255,255,255, 0.12)",

                Background = "#1A1A27FF",
                BackgroundGrey = "#151521FF",

                Surface = "#1E1E2DFF",

                DrawerBackground = "#1A1A27FF",
                DrawerText = "#92929FFF",
                DrawerIcon = "#92929FFF",

                AppbarBackground = "#1A1A27CC",
                AppbarText = "#92929FFF",

                LinesDefault = "#33323EFF",
                LinesInputs = "#BDBDBDFF",

                TableLines = "#33323EFF",
                TableStriped = "#00000005",
                TableHover = "#0000000A",

                Divider = "#292838FF",
                DividerLight = "#000000CC",

                HoverOpacity = 0.06,

                GrayDefault = "#9E9E9E",
                GrayLight = "#2A2833",
                GrayLighter = "#1E1E2D",
                GrayDark = "#757575",
                GrayDarker = "#616161",

                OverlayDark = "rgba(33,33,33,0.4980392156862745)",
                OverlayLight = "#1e1e2d80"
            }
        };
}
